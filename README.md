# vhr-new 笔记

### 角色权限流程
涉及的表：`hr`、`hr_role`、`role`、`menu`、`menu_role`
- 查询流程（多表内连接）
  - hr_role表.`hrid` = 用户id **查询hr_role表.`rid`**（**角色id**）
    - menu_role表.`rid` = 角色id **查询menu_role表.`mid`**（**菜单id**）
      - **其他筛选条件**：menu表自连接 m1.`id` = m2.`parentId`、m2.`enabled` = true

### 前后端分离的权限管理思路
在传统的前后端不分离的开发中，权限管理主要通过<u>过滤器或者拦截器</u>来进行（权限管理框架本身也是通过过滤器来实现功能），如果用户不具备某一个角色或者某一个权限，则无法访问某一个页面。

**在前后端分离中，页面的跳转都交给前端去做，后端只提供数据，这种时候权限管理不能再按照之前的思路来做。**

- 前端是展示给用户看的，所有的菜单显示或者隐藏**目的不是为了实现权限管理，而是为了给用户一个良好的体验**，**<u>不能依靠前端隐藏控件来实现权限管理，即数据安全不能依靠前端</u>**。
- **真正的数据安全管理、权限管理是在后端实现的**，后端在接口设计的过程中，**要确保每一个接口都是在满足某种权限的基础上才能访问**。也就是说，不怕将后端数据接口地址暴露出来，即使暴露出来，只要你没有相应的角色，也是访问不了的。

总结：<u>前端所有的操作都是为了提高用户体验</u>，不能通过前端控制菜单等数据的显示或隐藏来实现权限管理，<u>这只是因为后端决定的权限导致部分菜单等数据无法访问，所以为了提供用户体验需要将用户不能访问的接口或者菜单隐藏起来</u>。比如前端请求后端菜单项数据之后动态加载菜单项，只是为了提高用户体验、前端做数据校验是为了提高效率，提高用户体验，后端需要真正的确保数据完整性。